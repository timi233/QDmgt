# Channel Management API Contract

**Endpoint**: `PUT /api/channels/{channel_id}/execution-plans/{plan_id}`  
**Method**: PUT  
**Version**: 1.0  
**Feature**: Channel Management System

## Purpose
Update an existing execution plan with execution status, obstacles, and next steps (particularly for weekly tracking).

## Request

### Path Parameters
- `channel_id`: UUID of the channel
- `plan_id`: UUID of the execution plan to update

### Headers
- `Authorization: Bearer <token>` - Required authentication token
- `Content-Type: application/json`

### Body
```json
{
  "plan_content": "Focus on expanding relationships with basic盘 channels, identify new opportunities in high-value channels",
  "execution_status": "In progress, initial meetings scheduled",
  "key_obstacles": "Delayed response from two key contacts",
  "next_steps": "Follow up with contacts, prepare Q4 forecast",
  "status": "in-progress"
}
```

### Body Validation
- `plan_content`: Optional string, updated plan content if needed
- `execution_status`: Optional string, describes current status of execution
- `key_obstacles`: Optional string, describes any obstacles encountered
- `next_steps`: Optional string, describes next planned actions
- `status`: Optional string, must be one of "planned", "in-progress", "completed", "archived"

## Response

### Success Response (200 OK)
```json
{
  "id": "uuid-string",
  "channel_id": "uuid-string",
  "user_id": "uuid-string",
  "plan_type": "weekly",
  "plan_period": "2025-W40",
  "plan_content": "Focus on expanding relationships with basic盘 channels, identify new opportunities in high-value channels",
  "execution_status": "In progress, initial meetings scheduled",
  "key_obstacles": "Delayed response from two key contacts",
  "next_steps": "Follow up with contacts, prepare Q4 forecast",
  "status": "in-progress",
  "created_at": "2025-10-11T10:00:00Z",
  "updated_at": "2025-10-11T11:00:00Z"
}
```

### Error Responses
- `400 Bad Request`: Invalid request body format
- `401 Unauthorized`: Invalid or missing authentication token
- `403 Forbidden`: User lacks permission to update this execution plan
- `404 Not Found`: Channel or execution plan with specified IDs do not exist
- `422 Unprocessable Entity`: Validation errors in request body

## Business Rules
- Only the user who created the plan or users with admin permissions can update the execution plan
- The updated_at field will be automatically set to the current timestamp
- Weekly plans particularly benefit from updates to execution_status, key_obstacles, and next_steps fields
- Status can be updated to reflect the current state of the plan