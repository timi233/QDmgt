# 渠道管理系统优化方案

基于深信服渠道管理系统分析

## 一、核心功能对比

### 深信服系统核心功能
1. **目标管理体系**
   - 年度目标制定（基本盘、高价值、普通金牌渠道）
   - 季度目标拆解（Q1-Q4）
   - 月度目标细化（按月拆分）
   - 目标维度：新签、核心商机、核心业绩、高价值商机、高价值业绩

2. **数据可视化驾驶舱**
   - 基本盘目标完成（进度条+同比数据）
   - 目标完成占比趋势图（季度柱状图）
   - 渠道目标分析（环形图）
   - 新签目标统计

3. **渠道分层管理**
   - 基本盘渠道
   - 高价值渠道
   - 待签约渠道
   - 普通金牌渠道

4. **工作计划闭环**
   - 月度工作计划（商机来源、项目管理、渠道认可动作）
   - 每周工作梳理（进展分析、障碍排查、计划调整）

### 我们系统现有功能
✅ 分销商基础信息管理（CRUD）
✅ 任务管理系统
✅ 用户角色权限
✅ 基础数据看板（主管可见）

### 功能差距
❌ 缺少目标管理模块
❌ 缺少目标进度可视化
❌ 分销商分类不够细致
❌ 缺少工作计划跟踪
❌ 缺少周报/月报功能

## 二、优化实施方案

### 阶段一：数据模型扩展（优先级：高）

#### 1. 渠道目标管理
```prisma
// 渠道目标表
model ChannelTarget {
  id                String   @id @default(uuid())
  year              Int                           // 年度
  quarter           String?                       // 季度 Q1/Q2/Q3/Q4
  month             Int?                          // 月份 1-12
  targetType        String                        // 目标类型：yearly/quarterly/monthly

  // 目标指标
  newSignTarget     Float    @default(0)         // 新签目标
  coreOpportunity   Float    @default(0)         // 核心商机目标
  coreRevenue       Float    @default(0)         // 核心业绩目标
  highValueOpp      Float    @default(0)         // 高价值商机目标
  highValueRevenue  Float    @default(0)         // 高价值业绩目标

  // 完成情况
  newSignCompleted  Float    @default(0)         // 新签完成
  coreOppCompleted  Float    @default(0)         // 核心商机完成
  coreRevCompleted  Float    @default(0)         // 核心业绩完成
  highValueOppComp  Float    @default(0)         // 高价值商机完成
  highValueRevComp  Float    @default(0)         // 高价值业绩完成

  userId            String                        // 负责人
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  user              User     @relation("TargetOwner", fields: [userId], references: [id])

  @@index([year, quarter, month])
  @@index([userId])
  @@map("channel_targets")
}

// 分销商扩展字段（修改现有 Distributor 模型）
model Distributor {
  // ... 现有字段 ...

  // 新增分类字段
  channelType       String   @default("normal")  // 渠道类型：basic_plate/high_value/pending/normal_gold/other
  quarterlyTarget   Float    @default(0)         // 季度目标
  quarterlyCompleted Float   @default(0)         // 季度完成
  projectCount      Int      @default(0)         // 项目保有数量
  projectAmount     Float    @default(0)         // 项目保有金额

  // 关联工作计划
  workPlans         WorkPlan[]
}
```

#### 2. 工作计划管理
```prisma
// 月度工作计划
model WorkPlan {
  id              String   @id @default(uuid())
  distributorId   String
  userId          String
  year            Int
  month           Int

  // 计划内容
  opportunitySource String?                    // 商机来源
  projectMgmt      String?                     // 项目管理计划
  channelActions   String?                     // 渠道认可动作

  // 状态
  status          String   @default("planning") // planning/executing/completed

  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  distributor     Distributor @relation(fields: [distributorId], references: [id])
  user            User        @relation("WorkPlanOwner", fields: [userId], references: [id])
  weeklyReviews   WeeklyReview[]

  @@index([distributorId])
  @@index([userId])
  @@index([year, month])
  @@map("work_plans")
}

// 每周工作梳理
model WeeklyReview {
  id            String   @id @default(uuid())
  workPlanId    String
  weekNumber    Int                           // 周数
  year          Int

  // 梳理内容
  progress      String?                       // 进展分析
  obstacles     String?                       // 障碍排查
  adjustments   String?                       // 计划调整

  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  workPlan      WorkPlan @relation(fields: [workPlanId], references: [id])

  @@index([workPlanId])
  @@index([year, weekNumber])
  @@map("weekly_reviews")
}
```

### 阶段二：前端页面开发（优先级：高）

#### 1. 数据看板增强
**位置**: `/dashboard`（主管专属）

**新增组件**:
- 目标完成进度卡片（业绩、商机）
- 季度趋势柱状图
- 渠道目标分析环形图
- 新签目标统计

#### 2. 渠道目标管理页面
**位置**: `/targets/manage`

**功能**:
- 年度目标制定
- 季度目标拆解
- 月度目标细化
- 目标完成进度展示

#### 3. 分销商列表优化
**位置**: `/distributors`

**新增**:
- 渠道类型筛选（基本盘/高价值/待签约/普通金牌）
- 季度目标显示列
- 目标完成百分比
- 月度工作计划入口
- 每周工作梳理入口

#### 4. 工作计划管理
**位置**: `/work-plans`

**功能**:
- 月度工作计划创建/编辑
- 每周工作梳理记录
- 计划执行状态跟踪

### 阶段三：API 接口开发（优先级：高）

#### 目标管理 API
```typescript
// POST /api/targets - 创建目标
// GET /api/targets - 获取目标列表
// GET /api/targets/:id - 获取目标详情
// PUT /api/targets/:id - 更新目标
// GET /api/targets/statistics - 获取目标统计数据
```

#### 工作计划 API
```typescript
// POST /api/work-plans - 创建工作计划
// GET /api/work-plans - 获取工作计划列表
// PUT /api/work-plans/:id - 更新工作计划
// POST /api/work-plans/:id/weekly-reviews - 添加周报
```

#### 数据看板 API 增强
```typescript
// GET /api/dashboard/target-progress - 目标进度
// GET /api/dashboard/channel-analysis - 渠道分析
// GET /api/dashboard/quarterly-trend - 季度趋势
```

## 三、实施优先级

### P0 - 立即实施（本周）
1. ✅ 添加导航菜单
2. ✅ 前端界面中文化
3. ⏳ 数据库模型扩展
4. ⏳ 分销商列表优化

### P1 - 近期实施（下周）
1. 目标管理模块开发
2. 数据看板增强
3. 工作计划管理

### P2 - 后续优化（两周后）
1. 数据导入导出
2. 报表生成
3. 移动端适配

## 四、技术实现建议

### 数据可视化
- 使用 ECharts 或 Recharts 实现图表
- 进度条使用 Ant Design Progress 组件
- 环形图展示目标占比

### 性能优化
- 使用 Redis 缓存看板数据
- 大数据量列表使用虚拟滚动
- 图表数据按需加载

### 用户体验
- 添加快捷操作按钮
- 优化表格行操作
- 添加数据导出功能
- 移动端响应式布局

## 五、预期效果

实施后系统将具备：
1. ✅ 完整的目标管理体系（年/季/月）
2. ✅ 可视化数据驾驶舱
3. ✅ 渠道分层精细化管理
4. ✅ 工作计划闭环跟踪
5. ✅ 与深信服系统功能对齐

## 六、下一步行动

建议按以下顺序实施：
1. **立即开始**: 扩展数据库模型（添加目标、工作计划表）
2. **本周完成**: 优化分销商列表（添加分类、目标字段）
3. **下周开始**: 开发目标管理和工作计划功能
4. **持续优化**: 完善数据看板和报表功能
